<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
          xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
          x:Class="SledzSpecke.App.Views.SMKExportPage"
          Title="Eksport do SMK">
    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="15">
            <Label Text="Eksport danych do SMK" FontSize="20" FontAttributes="Bold" HorizontalOptions="Center" Margin="0,0,0,10"/>

            <Frame BorderColor="#e4f0f5" Padding="15" CornerRadius="10">
                <VerticalStackLayout Spacing="10">
                    <Label Text="Wybierz typ eksportu" FontSize="16" FontAttributes="Bold"/>

                    <RadioButton x:Name="GeneralExportRadioButton" Content="Eksport ogólny" IsChecked="True" GroupName="ExportTypeGroup"/>
                    <RadioButton x:Name="ProcedureExportRadioButton" Content="Eksport procedur w formacie SMK" GroupName="ExportTypeGroup"/>
                    <RadioButton x:Name="DutyShiftExportRadioButton" Content="Eksport dyżurów w formacie SMK" GroupName="ExportTypeGroup"/>
                </VerticalStackLayout>
            </Frame>

            <!-- Options for general export -->
            <Frame BorderColor="#e4f0f5" Padding="15" CornerRadius="10" IsVisible="{Binding IsGeneralExportSelected}">
                <VerticalStackLayout Spacing="10">
                    <Label Text="Wybierz zakres danych do eksportu" FontSize="16" FontAttributes="Bold"/>

                    <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto" ColumnSpacing="10" RowSpacing="10">
                        <CheckBox x:Name="CoursesCheckBox" IsChecked="True" Grid.Column="0" Grid.Row="0"/>
                        <Label Text="Kursy" VerticalOptions="Center" Grid.Column="1" Grid.Row="0"/>

                        <CheckBox x:Name="InternshipsCheckBox" IsChecked="True" Grid.Column="0" Grid.Row="1"/>
                        <Label Text="Staże" VerticalOptions="Center" Grid.Column="1" Grid.Row="1"/>

                        <CheckBox x:Name="ProceduresCheckBox" IsChecked="True" Grid.Column="0" Grid.Row="2"/>
                        <Label Text="Procedury" VerticalOptions="Center" Grid.Column="1" Grid.Row="2"/>
                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <Frame BorderColor="#e4f0f5" Padding="15" CornerRadius="10">
                <VerticalStackLayout Spacing="10">
                    <Label Text="Wybierz format eksportu" FontSize="16" FontAttributes="Bold"/>

                    <Picker x:Name="FormatPicker" Title="Wybierz format" SelectedIndex="0">
                        <Picker.Items>
                            <x:String>Excel (.xlsx)</x:String>
                            <x:String>CSV (.csv)</x:String>
                        </Picker.Items>
                    </Picker>
                </VerticalStackLayout>
            </Frame>

            <Frame BorderColor="#e4f0f5" Padding="15" CornerRadius="10">
                <VerticalStackLayout Spacing="10">
                    <Label Text="Wybierz moduł" FontSize="16" FontAttributes="Bold"/>

                    <RadioButton x:Name="AllModulesRadioButton" Content="Wszystkie moduły" IsChecked="True" GroupName="ModuleGroup"/>
                    <RadioButton x:Name="BasicModuleRadioButton" Content="Tylko moduł podstawowy" GroupName="ModuleGroup"/>
                    <RadioButton x:Name="SpecialisticModuleRadioButton" Content="Tylko moduł specjalistyczny" GroupName="ModuleGroup"/>
                </VerticalStackLayout>
            </Frame>

            <Frame BorderColor="#e4f0f5" Padding="15" CornerRadius="10">
                <VerticalStackLayout Spacing="10">
                    <Label Text="Zakres dat" FontSize="16" FontAttributes="Bold"/>

                    <RadioButton x:Name="AllDatesRadioButton" Content="Wszystkie daty" IsChecked="True" GroupName="DateGroup"/>
                    <RadioButton x:Name="CustomDatesRadioButton" Content="Niestandardowy zakres dat" GroupName="DateGroup" CheckedChanged="OnCustomDatesCheckedChanged"/>

                    <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto,Auto" ColumnSpacing="10" RowSpacing="10" IsVisible="False" x:Name="DateRangeGrid">
                        <Label Text="Od:" VerticalOptions="Center" Grid.Column="0" Grid.Row="0"/>
                        <DatePicker x:Name="StartDatePicker" Grid.Column="1" Grid.Row="0"/>

                        <Label Text="Do:" VerticalOptions="Center" Grid.Column="0" Grid.Row="1"/>
                        <DatePicker x:Name="EndDatePicker" Grid.Column="1" Grid.Row="1"/>
                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <!-- New section for SMK format options -->
            <Frame BorderColor="#e4f0f5" Padding="15" CornerRadius="10">
                <VerticalStackLayout Spacing="10">
                    <Label Text="Opcje formatu SMK" FontSize="16" FontAttributes="Bold"/>

                    <StackLayout Orientation="Horizontal">
                        <CheckBox x:Name="UseSmkExactFormatCheckBox" IsChecked="True"/>
                        <Label Text="Użyj dokładnego formatu SMK" VerticalOptions="Center"/>
                    </StackLayout>

                    <Label Text="Zgodnie z instrukcją SMK, eksport będzie zawierał wszystkie wymagane kolumny w odpowiednim formacie." 
                           FontSize="12" TextColor="#547E9E"/>
                </VerticalStackLayout>
            </Frame>

            <Button Text="Generuj raport" Clicked="OnGenerateReportClicked" BackgroundColor="#082044" TextColor="White"/>

            <Frame BorderColor="#e4f0f5" Padding="15" CornerRadius="10" IsVisible="False" x:Name="ResultFrame">
                <VerticalStackLayout Spacing="10">
                    <Label Text="Raport został wygenerowany" FontSize="16" FontAttributes="Bold" HorizontalOptions="Center"/>
                    <Label x:Name="FilePathLabel" Text="Ścieżka pliku: /Downloads/SMK_Export_20230301.xlsx" TextColor="#0d759c"/>

                    <HorizontalStackLayout Spacing="10" HorizontalOptions="Center">
                        <Button Text="Otwórz plik" Clicked="OnOpenFileClicked" BackgroundColor="Green" TextColor="White"/>
                        <Button Text="Otwórz folder" Clicked="OnOpenFolderClicked" BackgroundColor="Gray" TextColor="White"/>
                    </HorizontalStackLayout>
                </VerticalStackLayout>
            </Frame>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>